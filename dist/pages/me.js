"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),_wepy=require("./../npm/wepy/lib/wepy.js"),_wepy2=_interopRequireDefault(_wepy),_urls=require("./../services/urls.js"),_urls2=_interopRequireDefault(_urls),_loading=require("./../services/loading.js"),_loading2=_interopRequireDefault(_loading),_util=require("./../services/util.js"),_util2=_interopRequireDefault(_util),_moment=require("./../npm/moment/moment.js"),_moment2=_interopRequireDefault(_moment),_request=require("./../services/request.js"),_request2=_interopRequireDefault(_request),_nullList=require("./../components/nullList.js"),_nullList2=_interopRequireDefault(_nullList),Me=function(e){function t(){var e,o,n,r;_classCallCheck(this,t);for(var u=arguments.length,a=Array(u),l=0;l<u;l++)a[l]=arguments[l];return o=n=_possibleConstructorReturn(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.config={navigationBarTitleText:"æˆ‘",enablePullDownRefresh:!0},n.$repeat={},n.$props={"null-list":{"xmlns:wx":""}},n.$events={},n.components={"null-list":_nullList2.default},n.data={userInfo:null,recordData:null,bookingData:null,userData:null,type:"booking"},n.computed={},n.methods={toBooking:function(e){console.log("to booking page",e),_wepy2.default.navigateTo({url:"/pages/booking-detail?id="+e+"&type=detail"})},toChallenge:function(e){console.log("to challenge page",e),_wepy2.default.navigateTo({url:"/pages/challenge?id="+e})},selectTab:function(e){n.type=e,_wepy2.default.pageScrollTo&&_wepy2.default.pageScrollTo({scrollTop:0})},updateRecord:function(){_request2.default.get(_urls2.default.record).then(function(e){var t=e.result;n.recordData=t,n.methods.convertData(n.recordData),n.$apply()})},updateBooking:function(){_request2.default.get(_urls2.default.booking).then(function(e){var t=e.result;n.bookingData=t,n.methods.convertData(n.bookingData),n.$apply()})},updateUser:function(){_request2.default.get(_urls2.default.user).then(function(e){var t=e.result;n.userData=t,n.$apply(),_loading2.default.hide(),_wepy2.default.stopPullDownRefresh()})},convertData:function(e){_util2.default.each(e,function(e){var t=(0,_moment2.default)(e.date);e.date1=t.format("YYYY-M"),e.date2=t.format("DD"),e.date3=t.format("HH:mm")})}},n.events={},r=o,_possibleConstructorReturn(n,r)}return _inherits(t,e),_createClass(t,[{key:"onPullDownRefresh",value:function(){this.methods.updateBooking(),this.methods.updateRecord(),this.methods.updateUser()}},{key:"onShow",value:function(){var e=this,t=this;console.log("me on show"),_request2.default.getUserInfo().then(function(o){t.userInfo=o,e.methods.updateBooking(),e.methods.updateRecord(),e.methods.updateUser()})}},{key:"onLoad",value:function(){console.log("me on load"),_loading2.default.show()}}]),t}(_wepy2.default.page);Page(require("./../npm/wepy/lib/wepy.js").default.$createPage(Me,"pages/me"));